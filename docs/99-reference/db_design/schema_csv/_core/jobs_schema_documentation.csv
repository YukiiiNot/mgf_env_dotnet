FieldKey,Type,Primary,Nullable,Default,Computed,DerivesFrom,FKTarget,EnumGroup,Constraints,SourceSystem,UpdatePolicy,Indexed,Sensitivity,Description,Example,Notes
job_id,text,True,False,,False,,,,CHECK (job_id ~ '^job_[0-9a-hjkmnp-tv-z]{26}$'),Supabase,immutable,True,internal,Primary identifier for queued background job,job_01h9x3k7m2p4r6t8v0w1y2z3ab,
job_type_key,text,False,False,,False,,job_types.job_type_key,job_types,FOREIGN KEY,System,controlled,True,internal,Type of job to execute (maps to worker handler),dropbox.provision_project_folders,
topic_key,text,False,True,,False,,,,,System,editable,True,internal,Optional topic grouping (similar to activity topics),daemon.dropbox,
entity_key,text,False,True,,False,,,,,System,editable,True,internal,Polymorphic entity key this job relates to (not a FK),prj_01HF9ABC123,
entity_type_key,text,False,True,,False,,,,CHECK (entity_type_key ~ '^[a-z0-9_]+$'),System,editable,False,internal,Optional polymorphic entity type key to disambiguate entity_key,project,
status_key,text,False,False,queued,False,,job_statuses.status_key,job_statuses,FOREIGN KEY,System,system,True,internal,Job lifecycle status,running,
priority_key,text,False,False,normal,False,,job_priorities.priority_key,job_priorities,FOREIGN KEY,System,system,True,internal,Job priority,high,
payload,jsonb,False,False,'{}'::jsonb,False,,,,,System,system,False,internal,Job payload for worker execution,"{""project_id"":""prj_..."",""root"":""nas_home""}",
attempt_count,integer,False,False,0,False,,,,CHECK (attempt_count >= 0),System,system,False,internal,Number of attempts so far,1,
max_attempts,integer,False,False,10,False,,,,CHECK (max_attempts >= 1),System,editable,False,internal,Maximum attempts before job is marked failed,10,
run_after,timestamptz,False,False,now(),False,,,,,System,system,True,internal,When the job becomes eligible to run (for scheduling/backoff),2025-03-11T10:00:00Z,
locked_by,text,False,True,,False,,,,,System,system,True,internal,Worker instance id that claimed the job,worker-01,
locked_until,timestamptz,False,True,,False,,,,,System,system,True,internal,Lock expiry timestamp for the claim,2025-03-11T10:05:00Z,Workers should extend or release lock; prevents double-processing.
last_error,text,False,True,,False,,,,,System,system,False,internal,Last error message/stack summary,Dropbox API 429 rate limit,
created_at,timestamptz,False,False,now(),True,system,,,,Supabase,immutable,True,internal,Row creation timestamp,2025-03-10T15:00:00Z,
started_at,timestamptz,False,True,,False,,,,,System,system,False,internal,When a worker started processing the job,2025-03-11T10:00:10Z,
finished_at,timestamptz,False,True,,False,,,,,System,system,False,internal,When the job finished processing,2025-03-11T10:00:45Z,
created_by_actor,text,False,True,,False,,,,,MGFilms Pro,system,True,internal,Actor that enqueued the job (per_... or system/...),system/daemon.sync,
activity_id,text,False,True,,False,,activity_log.activity_id,,FOREIGN KEY,System,system,True,internal,Optional linkage to activity that triggered this job,evt_01h9x3k7m2p4r6t8v0w1y2z3ab,
