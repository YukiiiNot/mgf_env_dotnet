// <auto-generated />
using System;
using System.Text.Json;
using MGF.Data.Data;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using Npgsql.EntityFrameworkCore.PostgreSQL.Metadata;

#nullable disable

namespace MGF.Data.Migrations
{
    [DbContext(typeof(AppDbContext))]
    [Migration("20251216074837_Phase1_05_SquareWebhookEvents")]
    partial class Phase1_05_SquareWebhookEvents
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "10.0.1")
                .HasAnnotation("Relational:MaxIdentifierLength", 63);

            NpgsqlModelBuilderExtensions.UseIdentityByDefaultColumns(modelBuilder);

            modelBuilder.Entity("MGF.Domain.Entities.Client", b =>
                {
                    b.Property<string>("ClientId")
                        .HasColumnType("text")
                        .HasColumnName("client_id");

                    b.Property<string>("AccountOwnerPersonId")
                        .HasColumnType("text")
                        .HasColumnName("account_owner_person_id");

                    b.Property<string>("ClientTypeKey")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("client_type_key");

                    b.Property<DateTimeOffset>("CreatedAt")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("DataProfile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<string>("DisplayName")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<string>("Notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("PrimaryContactPersonId")
                        .HasColumnType("text")
                        .HasColumnName("primary_contact_person_id");

                    b.Property<string>("StatusKey")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset?>("UpdatedAt")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("ClientId");

                    b.HasIndex("AccountOwnerPersonId");

                    b.HasIndex("ClientId");

                    b.HasIndex("ClientTypeKey");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("DataProfile");

                    b.HasIndex("DisplayName");

                    b.HasIndex("PrimaryContactPersonId");

                    b.HasIndex("StatusKey");

                    b.ToTable("clients", null, t =>
                        {
                            t.HasCheckConstraint("CK_clients_0", "client_id ~ '^cli_[0-9a-hjkmnp-tv-z]{26}$'");
                        });
                });

            modelBuilder.Entity("MGF.Domain.Entities.Person", b =>
                {
                    b.Property<string>("PersonId")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<DateTimeOffset>("CreatedAt")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("DataProfile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<string>("DefaultHostKey")
                        .HasColumnType("text")
                        .HasColumnName("default_host_key");

                    b.Property<string>("DisplayName")
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<string>("FirstName")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("first_name");

                    b.Property<string>("Initials")
                        .HasColumnType("text")
                        .HasColumnName("initials");

                    b.Property<string>("LastName")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("last_name");

                    b.Property<string>("Notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("StatusKey")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<string>("Timezone")
                        .HasColumnType("text")
                        .HasColumnName("timezone");

                    b.Property<DateTimeOffset?>("UpdatedAt")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("PersonId");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("DataProfile");

                    b.HasIndex("DefaultHostKey");

                    b.HasIndex("FirstName");

                    b.HasIndex("LastName");

                    b.HasIndex("PersonId");

                    b.HasIndex("StatusKey");

                    b.ToTable("people", null, t =>
                        {
                            t.HasCheckConstraint("CK_people_0", "person_id ~ '^per_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_people_1", "char_length(initials) BETWEEN 1 AND 8");
                        });
                });

            modelBuilder.Entity("MGF.Domain.Entities.Project", b =>
                {
                    b.Property<string>("ProjectId")
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<DateTimeOffset?>("ArchivedAt")
                        .HasColumnType("timestamptz")
                        .HasColumnName("archived_at");

                    b.Property<string>("ClientId")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("client_id");

                    b.Property<DateTimeOffset>("CreatedAt")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("CurrentInvoiceId")
                        .HasColumnType("text")
                        .HasColumnName("current_invoice_id");

                    b.Property<string>("DataProfile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<DateOnly?>("DueDate")
                        .HasColumnType("date")
                        .HasColumnName("due_date");

                    b.Property<JsonElement>("Metadata")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata")
                        .HasDefaultValueSql("'{}'::jsonb");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("name");

                    b.Property<string>("PhaseKey")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("phase_key");

                    b.Property<string>("PriorityKey")
                        .HasColumnType("text")
                        .HasColumnName("priority_key");

                    b.Property<string>("ProjectCode")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_code");

                    b.Property<string>("StatusKey")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset?>("UpdatedAt")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("ProjectId");

                    b.HasIndex("ClientId");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("CurrentInvoiceId");

                    b.HasIndex("DataProfile");

                    b.HasIndex("PhaseKey");

                    b.HasIndex("PriorityKey");

                    b.HasIndex("ProjectCode")
                        .IsUnique();

                    b.HasIndex("ProjectId");

                    b.HasIndex("StatusKey");

                    b.ToTable("projects", null, t =>
                        {
                            t.HasCheckConstraint("CK_projects_0", "project_id ~ '^prj_[A-Za-z0-9]+$'");

                            t.HasCheckConstraint("CK_projects_1", "project_code ~ '^MGF[0-9]{2}-[0-9]{4}$'");

                            t.HasCheckConstraint("CK_projects_2", "archived_at IS NULL OR status_key = 'archived'");
                        });
                });

            modelBuilder.Entity("MGF.Data.Data.SquareWebhookEvent", b =>
                {
                    b.Property<Guid>("SquareWebhookEventId")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("square_webhook_event_id")
                        .HasDefaultValueSql("gen_random_uuid()");

                    b.Property<string>("Error")
                        .HasColumnType("text")
                        .HasColumnName("error");

                    b.Property<string>("EventType")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("event_type");

                    b.Property<string>("LocationId")
                        .HasColumnType("text")
                        .HasColumnName("location_id");

                    b.Property<string>("ObjectId")
                        .HasColumnType("text")
                        .HasColumnName("object_id");

                    b.Property<string>("ObjectType")
                        .HasColumnType("text")
                        .HasColumnName("object_type");

                    b.Property<JsonElement>("Payload")
                        .HasColumnType("jsonb")
                        .HasColumnName("payload");

                    b.Property<DateTimeOffset?>("ProcessedAt")
                        .HasColumnType("timestamptz")
                        .HasColumnName("processed_at");

                    b.Property<DateTimeOffset>("ReceivedAt")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("received_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("SquareEventId")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("square_event_id");

                    b.Property<string>("Status")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("received")
                        .HasColumnName("status");

                    b.HasKey("SquareWebhookEventId");

                    b.HasIndex("SquareEventId")
                        .IsUnique();

                    b.ToTable("square_webhook_events", "public", t =>
                        {
                            t.HasCheckConstraint("CK_square_webhook_events_0", "status IN ('received','processed','failed')");
                        });
                });

            modelBuilder.Entity("activity_acknowledgements", b =>
                {
                    b.Property<string>("activity_id")
                        .HasColumnType("text")
                        .HasColumnName("activity_id");

                    b.Property<string>("acknowledged_by_actor")
                        .HasColumnType("text")
                        .HasColumnName("acknowledged_by_actor");

                    b.Property<DateTimeOffset>("acknowledged_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("acknowledged_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("activity_id", "acknowledged_by_actor");

                    b.HasIndex("acknowledged_at");

                    b.HasIndex("acknowledged_by_actor");

                    b.HasIndex("activity_id");

                    b.ToTable("activity_acknowledgements", (string)null);
                });

            modelBuilder.Entity("activity_log", b =>
                {
                    b.Property<string>("activity_id")
                        .HasColumnType("text")
                        .HasColumnName("activity_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("created_by_actor")
                        .HasColumnType("text")
                        .HasColumnName("created_by_actor");

                    b.Property<string>("entity_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("entity_key");

                    b.Property<string>("entity_type_key")
                        .HasColumnType("text")
                        .HasColumnName("entity_type_key");

                    b.Property<DateTimeOffset>("occurred_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("occurred_at");

                    b.Property<string>("occurred_at_local")
                        .HasColumnType("text")
                        .HasColumnName("occurred_at_local");

                    b.Property<string>("op_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("op_key");

                    b.Property<JsonElement>("payload")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("jsonb")
                        .HasColumnName("payload")
                        .HasDefaultValueSql("'{}'::jsonb");

                    b.Property<string>("priority_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("normal")
                        .HasColumnName("priority_key");

                    b.Property<int>("retry_count")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("retry_count");

                    b.Property<string>("source")
                        .HasColumnType("text")
                        .HasColumnName("source");

                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<string>("topic_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("topic_key");

                    b.HasKey("activity_id");

                    b.HasIndex("activity_id");

                    b.HasIndex("created_at");

                    b.HasIndex("created_by_actor");

                    b.HasIndex("entity_key");

                    b.HasIndex("occurred_at");

                    b.HasIndex("op_key");

                    b.HasIndex("priority_key");

                    b.HasIndex("source");

                    b.HasIndex("status_key");

                    b.HasIndex("topic_key");

                    b.ToTable("activity_log", null, t =>
                        {
                            t.HasCheckConstraint("CK_activity_log_0", "activity_id ~ '^evt_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_activity_log_1", "entity_type_key ~ '^[a-z0-9_]+$'");

                            t.HasCheckConstraint("CK_activity_log_2", "retry_count >= 0");
                        });
                });

            modelBuilder.Entity("activity_ops", b =>
                {
                    b.Property<string>("op_key")
                        .HasColumnType("text")
                        .HasColumnName("op_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("op_key");

                    b.HasIndex("created_at");

                    b.HasIndex("op_key");

                    b.ToTable("activity_ops", null, t =>
                        {
                            t.HasCheckConstraint("CK_activity_ops_0", "op_key ~ '^[a-z0-9_.-]+$'");
                        });
                });

            modelBuilder.Entity("activity_priorities", b =>
                {
                    b.Property<string>("priority_key")
                        .HasColumnType("text")
                        .HasColumnName("priority_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("priority_key");

                    b.HasIndex("created_at");

                    b.HasIndex("priority_key");

                    b.ToTable("activity_priorities", null, t =>
                        {
                            t.HasCheckConstraint("CK_activity_priorities_0", "priority_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("activity_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("activity_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_activity_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("activity_topics", b =>
                {
                    b.Property<string>("topic_key")
                        .HasColumnType("text")
                        .HasColumnName("topic_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("topic_key");

                    b.HasIndex("created_at");

                    b.HasIndex("topic_key");

                    b.ToTable("activity_topics", null, t =>
                        {
                            t.HasCheckConstraint("CK_activity_topics_0", "topic_key ~ '^[a-z0-9_.-]+$'");
                        });
                });

            modelBuilder.Entity("booking_attendees", b =>
                {
                    b.Property<string>("booking_attendee_id")
                        .HasColumnType("text")
                        .HasColumnName("booking_attendee_id");

                    b.Property<string>("booking_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("booking_id");

                    b.Property<DateTimeOffset?>("call_time")
                        .HasColumnType("timestamptz")
                        .HasColumnName("call_time");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("person_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<DateTimeOffset?>("release_time")
                        .HasColumnType("timestamptz")
                        .HasColumnName("release_time");

                    b.Property<string>("role_key")
                        .HasColumnType("text")
                        .HasColumnName("role_key");

                    b.HasKey("booking_attendee_id");

                    b.HasIndex("booking_attendee_id");

                    b.HasIndex("booking_id");

                    b.HasIndex("call_time");

                    b.HasIndex("created_at");

                    b.HasIndex("person_id");

                    b.HasIndex("release_time");

                    b.HasIndex("role_key");

                    b.HasIndex("booking_id", "person_id")
                        .IsUnique();

                    b.ToTable("booking_attendees", null, t =>
                        {
                            t.HasCheckConstraint("CK_booking_attendees_0", "booking_attendee_id ~ '^bka_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_booking_attendees_1", "release_time IS NULL OR call_time IS NULL OR release_time >= call_time");
                        });
                });

            modelBuilder.Entity("booking_phases", b =>
                {
                    b.Property<string>("phase_key")
                        .HasColumnType("text")
                        .HasColumnName("phase_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("phase_key");

                    b.HasIndex("created_at");

                    b.HasIndex("phase_key");

                    b.ToTable("booking_phases", null, t =>
                        {
                            t.HasCheckConstraint("CK_booking_phases_0", "phase_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("booking_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("booking_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_booking_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("bookings", b =>
                {
                    b.Property<string>("booking_id")
                        .HasColumnType("text")
                        .HasColumnName("booking_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("created_by_person_id")
                        .HasColumnType("text")
                        .HasColumnName("created_by_person_id");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<DateTimeOffset>("end_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("end_at");

                    b.Property<string>("google_event_id")
                        .HasColumnType("text")
                        .HasColumnName("google_event_id");

                    b.Property<int>("ingest_time_minutes")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(90)
                        .HasColumnName("ingest_time_minutes");

                    b.Property<string>("location_city")
                        .HasColumnType("text")
                        .HasColumnName("location_city");

                    b.Property<string>("location_country")
                        .HasColumnType("text")
                        .HasColumnName("location_country");

                    b.Property<string>("location_line1")
                        .HasColumnType("text")
                        .HasColumnName("location_line1");

                    b.Property<string>("location_line2")
                        .HasColumnType("text")
                        .HasColumnName("location_line2");

                    b.Property<string>("location_name")
                        .HasColumnType("text")
                        .HasColumnName("location_name");

                    b.Property<string>("location_notes")
                        .HasColumnType("text")
                        .HasColumnName("location_notes");

                    b.Property<string>("location_postal_code")
                        .HasColumnType("text")
                        .HasColumnName("location_postal_code");

                    b.Property<string>("location_region")
                        .HasColumnType("text")
                        .HasColumnName("location_region");

                    b.Property<JsonElement>("metadata")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata")
                        .HasDefaultValueSql("'{}'::jsonb");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("phase_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("scheduling")
                        .HasColumnName("phase_key");

                    b.Property<int>("prep_time_minutes")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(90)
                        .HasColumnName("prep_time_minutes");

                    b.Property<string>("project_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<DateTimeOffset>("start_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("start_at");

                    b.Property<string>("status_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("pending")
                        .HasColumnName("status_key");

                    b.Property<string>("timezone")
                        .HasColumnType("text")
                        .HasColumnName("timezone");

                    b.Property<string>("title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<int>("travel_time_minutes")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(90)
                        .HasColumnName("travel_time_minutes");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.Property<int>("wrap_time_minutes")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(90)
                        .HasColumnName("wrap_time_minutes");

                    b.HasKey("booking_id");

                    b.HasIndex("booking_id");

                    b.HasIndex("created_at");

                    b.HasIndex("created_by_person_id");

                    b.HasIndex("data_profile");

                    b.HasIndex("end_at");

                    b.HasIndex("google_event_id");

                    b.HasIndex("phase_key");

                    b.HasIndex("project_id");

                    b.HasIndex("start_at");

                    b.HasIndex("status_key");

                    b.HasIndex("title");

                    b.ToTable("bookings", null, t =>
                        {
                            t.HasCheckConstraint("CK_bookings_0", "booking_id ~ '^bkg_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_bookings_1", "end_at > start_at");

                            t.HasCheckConstraint("CK_bookings_2", "prep_time_minutes >= 0");

                            t.HasCheckConstraint("CK_bookings_3", "travel_time_minutes >= 0");

                            t.HasCheckConstraint("CK_bookings_4", "wrap_time_minutes >= 0");

                            t.HasCheckConstraint("CK_bookings_5", "ingest_time_minutes >= 0");
                        });
                });

            modelBuilder.Entity("client_billing_profiles", b =>
                {
                    b.Property<string>("client_id")
                        .HasColumnType("text")
                        .HasColumnName("client_id");

                    b.Property<string>("address_city")
                        .HasColumnType("text")
                        .HasColumnName("address_city");

                    b.Property<string>("address_country")
                        .HasColumnType("text")
                        .HasColumnName("address_country");

                    b.Property<string>("address_line1")
                        .HasColumnType("text")
                        .HasColumnName("address_line1");

                    b.Property<string>("address_line2")
                        .HasColumnType("text")
                        .HasColumnName("address_line2");

                    b.Property<string>("address_postal_code")
                        .HasColumnType("text")
                        .HasColumnName("address_postal_code");

                    b.Property<string>("address_region")
                        .HasColumnType("text")
                        .HasColumnName("address_region");

                    b.Property<string>("billing_email")
                        .HasColumnType("text")
                        .HasColumnName("billing_email");

                    b.Property<string>("billing_phone")
                        .HasColumnType("text")
                        .HasColumnName("billing_phone");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("tax_id")
                        .HasColumnType("text")
                        .HasColumnName("tax_id");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("client_id");

                    b.HasIndex("client_id");

                    b.HasIndex("created_at");

                    b.ToTable("client_billing_profiles", (string)null);
                });

            modelBuilder.Entity("client_contacts", b =>
                {
                    b.Property<string>("client_id")
                        .HasColumnType("text")
                        .HasColumnName("client_id");

                    b.Property<string>("person_id")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<bool>("is_primary")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_primary");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("role_key")
                        .HasColumnType("text")
                        .HasColumnName("role_key");

                    b.HasKey("client_id", "person_id");

                    b.HasIndex("client_id");

                    b.HasIndex("created_at");

                    b.HasIndex("is_primary");

                    b.HasIndex("person_id");

                    b.HasIndex("role_key");

                    b.ToTable("client_contacts", (string)null);
                });

            modelBuilder.Entity("client_integrations_square", b =>
                {
                    b.Property<string>("client_id")
                        .HasColumnType("text")
                        .HasColumnName("client_id");

                    b.Property<string>("creation_source_key")
                        .HasColumnType("text")
                        .HasColumnName("creation_source_key");

                    b.Property<string>("currency_code")
                        .HasColumnType("text")
                        .HasColumnName("currency_code");

                    b.Property<DateTimeOffset?>("first_visit_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("first_visit_at");

                    b.Property<DateTimeOffset?>("last_visit_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("last_visit_at");

                    b.Property<int?>("lifetime_spend_cents")
                        .HasColumnType("integer")
                        .HasColumnName("lifetime_spend_cents");

                    b.Property<string>("square_customer_id")
                        .HasColumnType("text")
                        .HasColumnName("square_customer_id");

                    b.Property<int?>("transaction_count")
                        .HasColumnType("integer")
                        .HasColumnName("transaction_count");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("client_id");

                    b.HasIndex("client_id");

                    b.HasIndex("creation_source_key");

                    b.HasIndex("square_customer_id")
                        .IsUnique();

                    b.ToTable("client_integrations_square", null, t =>
                        {
                            t.HasCheckConstraint("CK_client_integrations_square_0", "transaction_count >= 0");

                            t.HasCheckConstraint("CK_client_integrations_square_1", "lifetime_spend_cents >= 0");
                        });
                });

            modelBuilder.Entity("client_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("client_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_client_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("client_types", b =>
                {
                    b.Property<string>("type_key")
                        .HasColumnType("text")
                        .HasColumnName("type_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("type_key");

                    b.HasIndex("created_at");

                    b.HasIndex("type_key");

                    b.ToTable("client_types", null, t =>
                        {
                            t.HasCheckConstraint("CK_client_types_0", "type_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("currencies", b =>
                {
                    b.Property<string>("currency_code")
                        .HasColumnType("text")
                        .HasColumnName("currency_code");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<short?>("minor_units")
                        .HasColumnType("smallint")
                        .HasColumnName("minor_units");

                    b.Property<string>("symbol")
                        .HasColumnType("text")
                        .HasColumnName("symbol");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("currency_code");

                    b.HasIndex("created_at");

                    b.HasIndex("currency_code");

                    b.ToTable("currencies", null, t =>
                        {
                            t.HasCheckConstraint("CK_currencies_0", "currency_code ~ '^[A-Z]{3}$'");

                            t.HasCheckConstraint("CK_currencies_1", "minor_units IS NULL OR minor_units BETWEEN 0 AND 6");
                        });
                });

            modelBuilder.Entity("data_profiles", b =>
                {
                    b.Property<string>("profile_key")
                        .HasColumnType("text")
                        .HasColumnName("profile_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("profile_key");

                    b.HasIndex("created_at");

                    b.HasIndex("profile_key");

                    b.ToTable("data_profiles", null, t =>
                        {
                            t.HasCheckConstraint("CK_data_profiles_0", "profile_key IN ('real','dummy','fixture','legacy')");
                        });
                });

            modelBuilder.Entity("deliverable_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("deliverable_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_deliverable_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("deliverable_versions", b =>
                {
                    b.Property<string>("deliverable_version_id")
                        .HasColumnType("text")
                        .HasColumnName("deliverable_version_id");

                    b.Property<DateTimeOffset?>("approved_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("approved_at");

                    b.Property<string>("approved_by_person_id")
                        .HasColumnType("text")
                        .HasColumnName("approved_by_person_id");

                    b.Property<string>("client_feedback")
                        .HasColumnType("text")
                        .HasColumnName("client_feedback");

                    b.Property<DateTimeOffset?>("client_reviewed_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("client_reviewed_at");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("deliverable_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("deliverable_id");

                    b.Property<string>("delivery_link")
                        .HasColumnType("text")
                        .HasColumnName("delivery_link");

                    b.Property<string>("file_path")
                        .HasColumnType("text")
                        .HasColumnName("file_path");

                    b.Property<bool>("is_approved")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_approved");

                    b.Property<DateTimeOffset>("uploaded_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("uploaded_at");

                    b.Property<string>("uploaded_by_person_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("uploaded_by_person_id");

                    b.Property<string>("version_tag")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("version_tag");

                    b.HasKey("deliverable_version_id");

                    b.HasIndex("approved_at");

                    b.HasIndex("approved_by_person_id");

                    b.HasIndex("client_reviewed_at");

                    b.HasIndex("created_at");

                    b.HasIndex("deliverable_id");

                    b.HasIndex("deliverable_version_id");

                    b.HasIndex("is_approved");

                    b.HasIndex("uploaded_at");

                    b.HasIndex("uploaded_by_person_id");

                    b.HasIndex("version_tag");

                    b.ToTable("deliverable_versions", null, t =>
                        {
                            t.HasCheckConstraint("CK_deliverable_versions_0", "deliverable_version_id ~ '^dlvv_[A-Za-z0-9]+$'");

                            t.HasCheckConstraint("CK_deliverable_versions_1", "char_length(version_tag) BETWEEN 1 AND 50");
                        });
                });

            modelBuilder.Entity("deliverables", b =>
                {
                    b.Property<string>("deliverable_id")
                        .HasColumnType("text")
                        .HasColumnName("deliverable_id");

                    b.Property<DateTimeOffset?>("approved_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("approved_at");

                    b.Property<string>("approved_version_id")
                        .HasColumnType("text")
                        .HasColumnName("approved_version_id");

                    b.Property<string>("client_last_feedback")
                        .HasColumnType("text")
                        .HasColumnName("client_last_feedback");

                    b.Property<DateTimeOffset?>("client_last_reviewed_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("client_last_reviewed_at");

                    b.Property<DateTimeOffset>("created_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at");

                    b.Property<string>("created_by_person_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("created_by_person_id");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<string>("delivery_link")
                        .HasColumnType("text")
                        .HasColumnName("delivery_link");

                    b.Property<string>("delivery_method_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("delivery_method_key");

                    b.Property<string>("delivery_note")
                        .HasColumnType("text")
                        .HasColumnName("delivery_note");

                    b.Property<string>("invoice_id")
                        .HasColumnType("text")
                        .HasColumnName("invoice_id");

                    b.Property<bool>("is_locked")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_locked");

                    b.Property<bool>("payment_required")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("payment_required");

                    b.Property<string>("project_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<string>("status_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("deliverable_id");

                    b.HasIndex("approved_at");

                    b.HasIndex("approved_version_id");

                    b.HasIndex("client_last_reviewed_at");

                    b.HasIndex("created_at");

                    b.HasIndex("created_by_person_id");

                    b.HasIndex("data_profile");

                    b.HasIndex("deliverable_id");

                    b.HasIndex("delivery_method_key");

                    b.HasIndex("invoice_id");

                    b.HasIndex("is_locked");

                    b.HasIndex("payment_required");

                    b.HasIndex("project_id");

                    b.HasIndex("status_key");

                    b.ToTable("deliverables", null, t =>
                        {
                            t.HasCheckConstraint("CK_deliverables_0", "deliverable_id ~ '^dlv_[0-9a-hjkmnp-tv-z]{26}$'");
                        });
                });

            modelBuilder.Entity("delivery_methods", b =>
                {
                    b.Property<string>("method_key")
                        .HasColumnType("text")
                        .HasColumnName("method_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("method_key");

                    b.HasIndex("created_at");

                    b.HasIndex("method_key");

                    b.ToTable("delivery_methods", null, t =>
                        {
                            t.HasCheckConstraint("CK_delivery_methods_0", "method_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("host_keys", b =>
                {
                    b.Property<string>("host_key")
                        .HasColumnType("text")
                        .HasColumnName("host_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<string>("host_type_key")
                        .HasColumnType("text")
                        .HasColumnName("host_type_key");

                    b.Property<JsonElement?>("metadata")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata")
                        .HasDefaultValueSql("'{}'::jsonb");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("host_key");

                    b.HasIndex("created_at");

                    b.HasIndex("host_key");

                    b.ToTable("host_keys", null, t =>
                        {
                            t.HasCheckConstraint("CK_host_keys_0", "host_key ~ '^[a-z0-9_]+$'");

                            t.HasCheckConstraint("CK_host_keys_1", "host_type_key IS NULL OR host_type_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("integration_sync_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("integration_sync_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_integration_sync_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("invoice_integrations_square", b =>
                {
                    b.Property<string>("invoice_id")
                        .HasColumnType("text")
                        .HasColumnName("invoice_id");

                    b.Property<DateTimeOffset?>("last_synced_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("last_synced_at");

                    b.Property<string>("square_customer_id")
                        .HasColumnType("text")
                        .HasColumnName("square_customer_id");

                    b.Property<string>("square_invoice_id")
                        .HasColumnType("text")
                        .HasColumnName("square_invoice_id");

                    b.Property<string>("sync_status_key")
                        .HasColumnType("text")
                        .HasColumnName("sync_status_key");

                    b.HasKey("invoice_id");

                    b.HasIndex("invoice_id");

                    b.HasIndex("last_synced_at");

                    b.HasIndex("square_invoice_id")
                        .IsUnique();

                    b.HasIndex("sync_status_key");

                    b.ToTable("invoice_integrations_square", (string)null);
                });

            modelBuilder.Entity("invoice_items", b =>
                {
                    b.Property<string>("invoice_item_id")
                        .HasColumnType("text")
                        .HasColumnName("invoice_item_id");

                    b.Property<string>("description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<decimal?>("discount_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("discount_amount");

                    b.Property<string>("invoice_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("invoice_id");

                    b.Property<int>("line_number")
                        .HasColumnType("integer")
                        .HasColumnName("line_number");

                    b.Property<decimal>("line_total_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("line_total_amount");

                    b.Property<string>("name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("name");

                    b.Property<decimal>("quantity")
                        .HasColumnType("numeric(12,3)")
                        .HasColumnName("quantity");

                    b.Property<decimal>("unit_price_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("unit_price_amount");

                    b.HasKey("invoice_item_id");

                    b.HasIndex("invoice_id");

                    b.HasIndex("invoice_item_id");

                    b.HasIndex("line_number");

                    b.ToTable("invoice_items", null, t =>
                        {
                            t.HasCheckConstraint("CK_invoice_items_0", "invoice_item_id ~ '^ini_[A-Za-z0-9]+$'");

                            t.HasCheckConstraint("CK_invoice_items_1", "line_number >= 1");

                            t.HasCheckConstraint("CK_invoice_items_2", "quantity >= 0");

                            t.HasCheckConstraint("CK_invoice_items_3", "unit_price_amount >= 0");

                            t.HasCheckConstraint("CK_invoice_items_4", "discount_amount >= 0");

                            t.HasCheckConstraint("CK_invoice_items_5", "line_total_amount >= 0");
                        });
                });

            modelBuilder.Entity("invoice_number_counters", b =>
                {
                    b.Property<string>("prefix")
                        .HasColumnType("text")
                        .HasColumnName("prefix");

                    b.Property<short>("year_2")
                        .HasColumnType("smallint")
                        .HasColumnName("year_2");

                    b.Property<int>("next_seq")
                        .HasColumnType("integer")
                        .HasColumnName("next_seq");

                    b.Property<DateTimeOffset>("updated_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("prefix", "year_2");

                    b.HasIndex("prefix");

                    b.HasIndex("updated_at");

                    b.HasIndex("year_2");

                    b.ToTable("invoice_number_counters", null, t =>
                        {
                            t.HasCheckConstraint("CK_invoice_number_counters_0", "next_seq >= 0 AND next_seq <= 999999");
                        });
                });

            modelBuilder.Entity("invoice_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("invoice_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_invoice_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("invoices", b =>
                {
                    b.Property<string>("invoice_id")
                        .HasColumnType("text")
                        .HasColumnName("invoice_id");

                    b.Property<string>("client_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("client_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("currency_code")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("USD")
                        .HasColumnName("currency_code");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<DateTimeOffset?>("due_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("due_at");

                    b.Property<string>("invoice_number")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("invoice_number");

                    b.Property<DateTimeOffset>("issued_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("issued_at");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<DateTimeOffset?>("paid_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("paid_at");

                    b.Property<string>("payment_method_key")
                        .HasColumnType("text")
                        .HasColumnName("payment_method_key");

                    b.Property<string>("project_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<DateTimeOffset?>("refunded_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("refunded_at");

                    b.Property<string>("status_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("unpaid")
                        .HasColumnName("status_key");

                    b.Property<decimal>("subtotal_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("subtotal_amount");

                    b.Property<decimal?>("tax_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("tax_amount");

                    b.Property<decimal?>("tax_rate")
                        .HasColumnType("numeric(5,4)")
                        .HasColumnName("tax_rate");

                    b.Property<decimal>("total_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("total_amount");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("invoice_id");

                    b.HasIndex("client_id");

                    b.HasIndex("created_at");

                    b.HasIndex("currency_code");

                    b.HasIndex("data_profile");

                    b.HasIndex("due_at");

                    b.HasIndex("invoice_id");

                    b.HasIndex("invoice_number")
                        .IsUnique();

                    b.HasIndex("issued_at");

                    b.HasIndex("paid_at");

                    b.HasIndex("payment_method_key");

                    b.HasIndex("project_id");

                    b.HasIndex("status_key");

                    b.HasIndex("total_amount");

                    b.ToTable("invoices", null, t =>
                        {
                            t.HasCheckConstraint("CK_invoices_0", "invoice_id ~ '^inv_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_invoices_1", "invoice_number ~ '^MGF-INV-[0-9]{2}-[0-9]{6}$'");

                            t.HasCheckConstraint("CK_invoices_2", "subtotal_amount >= 0");

                            t.HasCheckConstraint("CK_invoices_3", "tax_rate BETWEEN 0 AND 1");

                            t.HasCheckConstraint("CK_invoices_4", "tax_amount >= 0");

                            t.HasCheckConstraint("CK_invoices_5", "total_amount >= 0");
                        });
                });

            modelBuilder.Entity("job_priorities", b =>
                {
                    b.Property<string>("priority_key")
                        .HasColumnType("text")
                        .HasColumnName("priority_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("priority_key");

                    b.HasIndex("created_at");

                    b.HasIndex("priority_key");

                    b.ToTable("job_priorities", null, t =>
                        {
                            t.HasCheckConstraint("CK_job_priorities_0", "priority_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("job_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("job_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_job_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("job_types", b =>
                {
                    b.Property<string>("job_type_key")
                        .HasColumnType("text")
                        .HasColumnName("job_type_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<string>("handler")
                        .HasColumnType("text")
                        .HasColumnName("handler");

                    b.Property<bool>("is_active")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("job_type_key");

                    b.HasIndex("created_at");

                    b.HasIndex("job_type_key");

                    b.ToTable("job_types", null, t =>
                        {
                            t.HasCheckConstraint("CK_job_types_0", "job_type_key ~ '^[a-z0-9_.-]+$'");
                        });
                });

            modelBuilder.Entity("jobs", b =>
                {
                    b.Property<string>("job_id")
                        .HasColumnType("text")
                        .HasColumnName("job_id");

                    b.Property<string>("activity_id")
                        .HasColumnType("text")
                        .HasColumnName("activity_id");

                    b.Property<int>("attempt_count")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("attempt_count");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("created_by_actor")
                        .HasColumnType("text")
                        .HasColumnName("created_by_actor");

                    b.Property<string>("entity_key")
                        .HasColumnType("text")
                        .HasColumnName("entity_key");

                    b.Property<string>("entity_type_key")
                        .HasColumnType("text")
                        .HasColumnName("entity_type_key");

                    b.Property<DateTimeOffset?>("finished_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("finished_at");

                    b.Property<string>("job_type_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("job_type_key");

                    b.Property<string>("last_error")
                        .HasColumnType("text")
                        .HasColumnName("last_error");

                    b.Property<string>("locked_by")
                        .HasColumnType("text")
                        .HasColumnName("locked_by");

                    b.Property<DateTimeOffset?>("locked_until")
                        .HasColumnType("timestamptz")
                        .HasColumnName("locked_until");

                    b.Property<int>("max_attempts")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(10)
                        .HasColumnName("max_attempts");

                    b.Property<JsonElement>("payload")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("jsonb")
                        .HasColumnName("payload")
                        .HasDefaultValueSql("'{}'::jsonb");

                    b.Property<string>("priority_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("normal")
                        .HasColumnName("priority_key");

                    b.Property<DateTimeOffset>("run_after")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("run_after")
                        .HasDefaultValueSql("now()");

                    b.Property<DateTimeOffset?>("started_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("started_at");

                    b.Property<string>("status_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("queued")
                        .HasColumnName("status_key");

                    b.Property<string>("topic_key")
                        .HasColumnType("text")
                        .HasColumnName("topic_key");

                    b.HasKey("job_id");

                    b.HasIndex("activity_id");

                    b.HasIndex("created_at");

                    b.HasIndex("created_by_actor");

                    b.HasIndex("entity_key");

                    b.HasIndex("job_id");

                    b.HasIndex("job_type_key");

                    b.HasIndex("locked_by");

                    b.HasIndex("locked_until");

                    b.HasIndex("priority_key");

                    b.HasIndex("run_after");

                    b.HasIndex("status_key");

                    b.HasIndex("topic_key");

                    b.ToTable("jobs", null, t =>
                        {
                            t.HasCheckConstraint("CK_jobs_0", "job_id ~ '^job_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_jobs_1", "entity_type_key ~ '^[a-z0-9_]+$'");

                            t.HasCheckConstraint("CK_jobs_2", "attempt_count >= 0");

                            t.HasCheckConstraint("CK_jobs_3", "max_attempts >= 1");
                        });
                });

            modelBuilder.Entity("lead_outcomes", b =>
                {
                    b.Property<string>("outcome_key")
                        .HasColumnType("text")
                        .HasColumnName("outcome_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("outcome_key");

                    b.HasIndex("created_at");

                    b.HasIndex("outcome_key");

                    b.ToTable("lead_outcomes", null, t =>
                        {
                            t.HasCheckConstraint("CK_lead_outcomes_0", "outcome_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("lead_priorities", b =>
                {
                    b.Property<string>("priority_key")
                        .HasColumnType("text")
                        .HasColumnName("priority_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("priority_key");

                    b.HasIndex("created_at");

                    b.HasIndex("priority_key");

                    b.ToTable("lead_priorities", null, t =>
                        {
                            t.HasCheckConstraint("CK_lead_priorities_0", "priority_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("lead_sources", b =>
                {
                    b.Property<string>("source_key")
                        .HasColumnType("text")
                        .HasColumnName("source_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("source_key");

                    b.HasIndex("created_at");

                    b.HasIndex("source_key");

                    b.ToTable("lead_sources", null, t =>
                        {
                            t.HasCheckConstraint("CK_lead_sources_0", "source_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("lead_stages", b =>
                {
                    b.Property<string>("stage_key")
                        .HasColumnType("text")
                        .HasColumnName("stage_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("stage_key");

                    b.HasIndex("created_at");

                    b.HasIndex("stage_key");

                    b.ToTable("lead_stages", null, t =>
                        {
                            t.HasCheckConstraint("CK_lead_stages_0", "stage_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("lead_tags", b =>
                {
                    b.Property<string>("lead_id")
                        .HasColumnType("text")
                        .HasColumnName("lead_id");

                    b.Property<string>("tag_key")
                        .HasColumnType("text")
                        .HasColumnName("tag_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("lead_id", "tag_key");

                    b.HasIndex("created_at");

                    b.HasIndex("lead_id");

                    b.HasIndex("tag_key");

                    b.ToTable("lead_tags", (string)null);
                });

            modelBuilder.Entity("leads", b =>
                {
                    b.Property<string>("lead_id")
                        .HasColumnType("text")
                        .HasColumnName("lead_id");

                    b.Property<decimal?>("budget_estimate_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("budget_estimate_amount");

                    b.Property<string>("campaign")
                        .HasColumnType("text")
                        .HasColumnName("campaign");

                    b.Property<string>("company_name")
                        .HasColumnType("text")
                        .HasColumnName("company_name");

                    b.Property<string>("contact_display_name")
                        .HasColumnType("text")
                        .HasColumnName("contact_display_name");

                    b.Property<string>("contact_email")
                        .HasColumnType("text")
                        .HasColumnName("contact_email");

                    b.Property<string>("contact_person_id")
                        .HasColumnType("text")
                        .HasColumnName("contact_person_id");

                    b.Property<string>("contact_phone")
                        .HasColumnType("text")
                        .HasColumnName("contact_phone");

                    b.Property<DateTimeOffset?>("converted_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("converted_at");

                    b.Property<string>("converted_client_id")
                        .HasColumnType("text")
                        .HasColumnName("converted_client_id");

                    b.Property<string>("converted_project_id")
                        .HasColumnType("text")
                        .HasColumnName("converted_project_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<string>("interested_package_key")
                        .HasColumnType("text")
                        .HasColumnName("interested_package_key");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("outcome_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("open")
                        .HasColumnName("outcome_key");

                    b.Property<string>("priority_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("normal")
                        .HasColumnName("priority_key");

                    b.Property<string>("source_key")
                        .HasColumnType("text")
                        .HasColumnName("source_key");

                    b.Property<string>("stage_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("new")
                        .HasColumnName("stage_key");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("lead_id");

                    b.HasIndex("company_name");

                    b.HasIndex("contact_display_name");

                    b.HasIndex("contact_email");

                    b.HasIndex("contact_person_id");

                    b.HasIndex("converted_at");

                    b.HasIndex("converted_client_id");

                    b.HasIndex("converted_project_id");

                    b.HasIndex("created_at");

                    b.HasIndex("data_profile");

                    b.HasIndex("interested_package_key");

                    b.HasIndex("lead_id");

                    b.HasIndex("outcome_key");

                    b.HasIndex("priority_key");

                    b.HasIndex("source_key");

                    b.HasIndex("stage_key");

                    b.ToTable("leads", null, t =>
                        {
                            t.HasCheckConstraint("CK_leads_0", "lead_id ~ '^lead_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_leads_1", "budget_estimate_amount >= 0");
                        });
                });

            modelBuilder.Entity("path_anchors", b =>
                {
                    b.Property<string>("anchor_key")
                        .HasColumnType("text")
                        .HasColumnName("anchor_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("anchor_key");

                    b.HasIndex("anchor_key");

                    b.HasIndex("created_at");

                    b.ToTable("path_anchors", null, t =>
                        {
                            t.HasCheckConstraint("CK_path_anchors_0", "anchor_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("path_settings", b =>
                {
                    b.Property<int>("settings_id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasColumnName("settings_id");

                    NpgsqlPropertyBuilderExtensions.UseIdentityByDefaultColumn(b.Property<int>("settings_id"));

                    b.Property<string>("default_project_root_key")
                        .HasColumnType("text")
                        .HasColumnName("default_project_root_key");

                    b.Property<DateTimeOffset>("updated_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("settings_id");

                    b.HasIndex("default_project_root_key");

                    b.HasIndex("settings_id");

                    b.HasIndex("updated_at");

                    b.ToTable("path_settings", null, t =>
                        {
                            t.HasCheckConstraint("CK_path_settings_0", "settings_id = 1");
                        });
                });

            modelBuilder.Entity("path_templates", b =>
                {
                    b.Property<string>("path_key")
                        .HasColumnType("text")
                        .HasColumnName("path_key");

                    b.Property<string>("anchor_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("dropbox_root")
                        .HasColumnName("anchor_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("exists_required")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("exists_required");

                    b.Property<bool>("is_active")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("path_type_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("path_type_key");

                    b.Property<string>("relpath")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("relpath");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.Property<bool>("writable")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("writable");

                    b.HasKey("path_key");

                    b.HasIndex("anchor_key");

                    b.HasIndex("created_at");

                    b.HasIndex("exists_required");

                    b.HasIndex("is_active");

                    b.HasIndex("path_key");

                    b.HasIndex("path_type_key");

                    b.ToTable("path_templates", null, t =>
                        {
                            t.HasCheckConstraint("CK_path_templates_0", "path_key ~ '^[a-z0-9_]+$'");

                            t.HasCheckConstraint("CK_path_templates_1", "relpath !~ '^(\\/|[A-Za-z]:\\\\)' AND relpath !~ '\\\\' AND relpath !~ '(?:^|/)\\.\\.(?:/|$)'");
                        });
                });

            modelBuilder.Entity("path_types", b =>
                {
                    b.Property<string>("type_key")
                        .HasColumnType("text")
                        .HasColumnName("type_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("type_key");

                    b.HasIndex("created_at");

                    b.HasIndex("type_key");

                    b.ToTable("path_types", null, t =>
                        {
                            t.HasCheckConstraint("CK_path_types_0", "type_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("payment_methods", b =>
                {
                    b.Property<string>("method_key")
                        .HasColumnType("text")
                        .HasColumnName("method_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("method_key");

                    b.HasIndex("created_at");

                    b.HasIndex("method_key");

                    b.ToTable("payment_methods", null, t =>
                        {
                            t.HasCheckConstraint("CK_payment_methods_0", "method_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("payment_processors", b =>
                {
                    b.Property<string>("processor_key")
                        .HasColumnType("text")
                        .HasColumnName("processor_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("processor_key");

                    b.HasIndex("created_at");

                    b.HasIndex("processor_key");

                    b.ToTable("payment_processors", null, t =>
                        {
                            t.HasCheckConstraint("CK_payment_processors_0", "processor_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("payment_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("payment_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_payment_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("payments", b =>
                {
                    b.Property<string>("payment_id")
                        .HasColumnType("text")
                        .HasColumnName("payment_id");

                    b.Property<decimal>("amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("amount");

                    b.Property<DateTimeOffset?>("captured_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("captured_at");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("currency_code")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("USD")
                        .HasColumnName("currency_code");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<string>("invoice_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("invoice_id");

                    b.Property<string>("method_key")
                        .HasColumnType("text")
                        .HasColumnName("method_key");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("processor_key")
                        .HasColumnType("text")
                        .HasColumnName("processor_key");

                    b.Property<string>("processor_payment_id")
                        .HasColumnType("text")
                        .HasColumnName("processor_payment_id");

                    b.Property<string>("processor_refund_id")
                        .HasColumnType("text")
                        .HasColumnName("processor_refund_id");

                    b.Property<string>("recorded_by_person_id")
                        .HasColumnType("text")
                        .HasColumnName("recorded_by_person_id");

                    b.Property<decimal?>("refunded_amount")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("refunded_amount");

                    b.Property<DateTimeOffset?>("refunded_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("refunded_at");

                    b.Property<string>("source")
                        .HasColumnType("text")
                        .HasColumnName("source");

                    b.Property<string>("status_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("payment_id");

                    b.HasIndex("amount");

                    b.HasIndex("captured_at");

                    b.HasIndex("created_at");

                    b.HasIndex("currency_code");

                    b.HasIndex("data_profile");

                    b.HasIndex("invoice_id");

                    b.HasIndex("method_key");

                    b.HasIndex("payment_id");

                    b.HasIndex("processor_key");

                    b.HasIndex("processor_payment_id");

                    b.HasIndex("recorded_by_person_id");

                    b.HasIndex("refunded_at");

                    b.HasIndex("status_key");

                    b.ToTable("payments", null, t =>
                        {
                            t.HasCheckConstraint("CK_payments_0", "payment_id ~ '^pay_[0-9a-hjkmnp-tv-z]{26}$'");

                            t.HasCheckConstraint("CK_payments_1", "amount > 0");

                            t.HasCheckConstraint("CK_payments_2", "refunded_amount >= 0 AND refunded_amount <= amount");
                        });
                });

            modelBuilder.Entity("permissions", b =>
                {
                    b.Property<string>("permission_key")
                        .HasColumnType("text")
                        .HasColumnName("permission_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("permission_key");

                    b.HasIndex("created_at");

                    b.HasIndex("permission_key");

                    b.ToTable("permissions", null, t =>
                        {
                            t.HasCheckConstraint("CK_permissions_0", "permission_key ~ '^[a-z0-9_.]+$'");
                        });
                });

            modelBuilder.Entity("person_calendar_sync_settings", b =>
                {
                    b.Property<string>("person_id")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<bool>("include_personal_calendar")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("include_personal_calendar");

                    b.Property<string>("personal_calendar_source")
                        .HasColumnType("text")
                        .HasColumnName("personal_calendar_source");

                    b.Property<bool>("public_personal_events")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("public_personal_events");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("person_id");

                    b.HasIndex("person_id");

                    b.ToTable("person_calendar_sync_settings", (string)null);
                });

            modelBuilder.Entity("person_contacts", b =>
                {
                    b.Property<string>("person_id")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<string>("discord_handle")
                        .HasColumnType("text")
                        .HasColumnName("discord_handle");

                    b.Property<string>("email")
                        .HasColumnType("text")
                        .HasColumnName("email");

                    b.Property<string>("phone")
                        .HasColumnType("text")
                        .HasColumnName("phone");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("person_id");

                    b.HasIndex("email");

                    b.HasIndex("person_id");

                    b.ToTable("person_contacts", (string)null);
                });

            modelBuilder.Entity("person_known_hosts", b =>
                {
                    b.Property<string>("person_id")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<string>("host_key")
                        .HasColumnType("text")
                        .HasColumnName("host_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("person_id", "host_key");

                    b.HasIndex("created_at");

                    b.HasIndex("host_key");

                    b.HasIndex("person_id");

                    b.ToTable("person_known_hosts", (string)null);
                });

            modelBuilder.Entity("person_permissions", b =>
                {
                    b.Property<string>("person_id")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<string>("permission_key")
                        .HasColumnType("text")
                        .HasColumnName("permission_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("person_id", "permission_key");

                    b.HasIndex("created_at");

                    b.HasIndex("permission_key");

                    b.HasIndex("person_id");

                    b.ToTable("person_permissions", (string)null);
                });

            modelBuilder.Entity("person_roles", b =>
                {
                    b.Property<string>("person_id")
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<string>("role_key")
                        .HasColumnType("text")
                        .HasColumnName("role_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("person_id", "role_key");

                    b.HasIndex("created_at");

                    b.HasIndex("person_id");

                    b.HasIndex("role_key");

                    b.ToTable("person_roles", (string)null);
                });

            modelBuilder.Entity("person_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("person_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_person_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("project_code_counters", b =>
                {
                    b.Property<string>("prefix")
                        .HasColumnType("text")
                        .HasColumnName("prefix");

                    b.Property<short>("year_2")
                        .HasColumnType("smallint")
                        .HasColumnName("year_2");

                    b.Property<int>("next_seq")
                        .HasColumnType("integer")
                        .HasColumnName("next_seq");

                    b.Property<DateTimeOffset>("updated_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("prefix", "year_2");

                    b.HasIndex("prefix");

                    b.HasIndex("updated_at");

                    b.HasIndex("year_2");

                    b.ToTable("project_code_counters", null, t =>
                        {
                            t.HasCheckConstraint("CK_project_code_counters_0", "next_seq >= 0 AND next_seq <= 9999");
                        });
                });

            modelBuilder.Entity("project_members", b =>
                {
                    b.Property<string>("project_member_id")
                        .HasColumnType("text")
                        .HasColumnName("project_member_id");

                    b.Property<DateTimeOffset?>("assigned_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("assigned_at");

                    b.Property<bool>("is_active")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("person_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("person_id");

                    b.Property<string>("project_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<DateTimeOffset?>("released_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("released_at");

                    b.Property<string>("role_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("role_key");

                    b.HasKey("project_member_id");

                    b.HasIndex("assigned_at");

                    b.HasIndex("is_active");

                    b.HasIndex("person_id");

                    b.HasIndex("project_id");

                    b.HasIndex("project_member_id");

                    b.HasIndex("role_key");

                    b.ToTable("project_members", null, t =>
                        {
                            t.HasCheckConstraint("CK_project_members_0", "project_member_id ~ '^prm_[A-Za-z0-9]+$'");

                            t.HasCheckConstraint("CK_project_members_1", "is_active = true OR released_at IS NOT NULL");
                        });
                });

            modelBuilder.Entity("project_phases", b =>
                {
                    b.Property<string>("phase_key")
                        .HasColumnType("text")
                        .HasColumnName("phase_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("phase_key");

                    b.HasIndex("created_at");

                    b.HasIndex("phase_key");

                    b.ToTable("project_phases", null, t =>
                        {
                            t.HasCheckConstraint("CK_project_phases_0", "phase_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("project_priorities", b =>
                {
                    b.Property<string>("priority_key")
                        .HasColumnType("text")
                        .HasColumnName("priority_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("priority_key");

                    b.HasIndex("created_at");

                    b.HasIndex("priority_key");

                    b.ToTable("project_priorities", null, t =>
                        {
                            t.HasCheckConstraint("CK_project_priorities_0", "priority_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("project_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("project_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_project_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("project_storage_roots", b =>
                {
                    b.Property<string>("project_storage_root_id")
                        .HasColumnType("text")
                        .HasColumnName("project_storage_root_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("folder_relpath")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("folder_relpath");

                    b.Property<bool>("is_primary")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_primary");

                    b.Property<string>("project_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<string>("root_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("root_key");

                    b.Property<string>("share_url")
                        .HasColumnType("text")
                        .HasColumnName("share_url");

                    b.Property<string>("storage_provider_key")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("storage_provider_key");

                    b.HasKey("project_storage_root_id");

                    b.HasIndex("created_at");

                    b.HasIndex("is_primary");

                    b.HasIndex("project_id");

                    b.HasIndex("project_storage_root_id");

                    b.HasIndex("root_key");

                    b.HasIndex("storage_provider_key");

                    b.ToTable("project_storage_roots", null, t =>
                        {
                            t.HasCheckConstraint("CK_project_storage_roots_0", "project_storage_root_id ~ '^psr_[A-Za-z0-9]+$'");

                            t.HasCheckConstraint("CK_project_storage_roots_1", "folder_relpath !~ '(^/|\\\\\\\\|\\.\\.)'");
                        });
                });

            modelBuilder.Entity("role_scope_roles", b =>
                {
                    b.Property<string>("scope_key")
                        .HasColumnType("text")
                        .HasColumnName("scope_key");

                    b.Property<string>("role_key")
                        .HasColumnType("text")
                        .HasColumnName("role_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("scope_key", "role_key");

                    b.HasIndex("created_at");

                    b.HasIndex("role_key");

                    b.HasIndex("scope_key");

                    b.ToTable("role_scope_roles", (string)null);
                });

            modelBuilder.Entity("role_scopes", b =>
                {
                    b.Property<string>("scope_key")
                        .HasColumnType("text")
                        .HasColumnName("scope_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("scope_key");

                    b.HasIndex("created_at");

                    b.HasIndex("scope_key");

                    b.ToTable("role_scopes", null, t =>
                        {
                            t.HasCheckConstraint("CK_role_scopes_0", "scope_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("roles", b =>
                {
                    b.Property<string>("role_key")
                        .HasColumnType("text")
                        .HasColumnName("role_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("role_key");

                    b.HasIndex("created_at");

                    b.HasIndex("role_key");

                    b.ToTable("roles", null, t =>
                        {
                            t.HasCheckConstraint("CK_roles_0", "role_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("service_packages", b =>
                {
                    b.Property<string>("package_key")
                        .HasColumnType("text")
                        .HasColumnName("package_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<decimal?>("default_price")
                        .HasColumnType("numeric(12,2)")
                        .HasColumnName("default_price");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool>("is_active")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("is_active");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("package_key");

                    b.HasIndex("created_at");

                    b.HasIndex("package_key");

                    b.ToTable("service_packages", null, t =>
                        {
                            t.HasCheckConstraint("CK_service_packages_0", "package_key ~ '^[A-Z0-9_\\-]+$'");

                            t.HasCheckConstraint("CK_service_packages_1", "default_price IS NULL OR default_price >= 0");
                        });
                });

            modelBuilder.Entity("slug_reservations", b =>
                {
                    b.Property<string>("scope_key")
                        .HasColumnType("text")
                        .HasColumnName("scope_key");

                    b.Property<string>("slug")
                        .HasColumnType("text")
                        .HasColumnName("slug");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<DateTimeOffset?>("expires_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("expires_at");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<DateTimeOffset>("reserved_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("reserved_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("reserved_by_person_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("reserved_by_person_id");

                    b.HasKey("scope_key", "slug");

                    b.HasIndex("created_at");

                    b.HasIndex("data_profile");

                    b.HasIndex("expires_at");

                    b.HasIndex("reserved_at");

                    b.HasIndex("reserved_by_person_id");

                    b.HasIndex("scope_key");

                    b.HasIndex("slug");

                    b.ToTable("slug_reservations", null, t =>
                        {
                            t.HasCheckConstraint("CK_slug_reservations_0", "slug ~ '^[a-z0-9_-]{3,}$'");
                        });
                });

            modelBuilder.Entity("slug_scopes", b =>
                {
                    b.Property<string>("scope_key")
                        .HasColumnType("text")
                        .HasColumnName("scope_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("scope_key");

                    b.HasIndex("created_at");

                    b.HasIndex("scope_key");

                    b.ToTable("slug_scopes", null, t =>
                        {
                            t.HasCheckConstraint("CK_slug_scopes_0", "scope_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("square_customer_creation_sources", b =>
                {
                    b.Property<string>("source_key")
                        .HasColumnType("text")
                        .HasColumnName("source_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("source_key");

                    b.HasIndex("created_at");

                    b.HasIndex("source_key");

                    b.ToTable("square_customer_creation_sources", null, t =>
                        {
                            t.HasCheckConstraint("CK_square_customer_creation_sources_0", "source_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("storage_providers", b =>
                {
                    b.Property<string>("provider_key")
                        .HasColumnType("text")
                        .HasColumnName("provider_key");

                    b.Property<JsonElement?>("config")
                        .HasColumnType("jsonb")
                        .HasColumnName("config");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("provider_key");

                    b.HasIndex("created_at");

                    b.HasIndex("provider_key");

                    b.ToTable("storage_providers", null, t =>
                        {
                            t.HasCheckConstraint("CK_storage_providers_0", "provider_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("tags", b =>
                {
                    b.Property<string>("tag_key")
                        .HasColumnType("text")
                        .HasColumnName("tag_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("tag_key");

                    b.HasIndex("created_at");

                    b.HasIndex("tag_key");

                    b.ToTable("tags", null, t =>
                        {
                            t.HasCheckConstraint("CK_tags_0", "tag_key ~ '^[a-z0-9_\\-]+$'");
                        });
                });

            modelBuilder.Entity("work_item_priorities", b =>
                {
                    b.Property<string>("priority_key")
                        .HasColumnType("text")
                        .HasColumnName("priority_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("priority_key");

                    b.HasIndex("created_at");

                    b.HasIndex("priority_key");

                    b.ToTable("work_item_priorities", null, t =>
                        {
                            t.HasCheckConstraint("CK_work_item_priorities_0", "priority_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("work_item_statuses", b =>
                {
                    b.Property<string>("status_key")
                        .HasColumnType("text")
                        .HasColumnName("status_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("display_name")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("display_name");

                    b.Property<bool?>("is_terminal")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("is_terminal");

                    b.Property<int>("sort_order")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("sort_order");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("status_key");

                    b.HasIndex("created_at");

                    b.HasIndex("status_key");

                    b.ToTable("work_item_statuses", null, t =>
                        {
                            t.HasCheckConstraint("CK_work_item_statuses_0", "status_key ~ '^[a-z0-9_]+$'");
                        });
                });

            modelBuilder.Entity("work_item_tags", b =>
                {
                    b.Property<string>("work_item_id")
                        .HasColumnType("text")
                        .HasColumnName("work_item_id");

                    b.Property<string>("tag_key")
                        .HasColumnType("text")
                        .HasColumnName("tag_key");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.HasKey("work_item_id", "tag_key");

                    b.HasIndex("created_at");

                    b.HasIndex("tag_key");

                    b.HasIndex("work_item_id");

                    b.ToTable("work_item_tags", (string)null);
                });

            modelBuilder.Entity("work_items", b =>
                {
                    b.Property<string>("work_item_id")
                        .HasColumnType("text")
                        .HasColumnName("work_item_id");

                    b.Property<string>("assigned_to_person_id")
                        .HasColumnType("text")
                        .HasColumnName("assigned_to_person_id");

                    b.Property<DateTimeOffset>("created_at")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("timestamptz")
                        .HasColumnName("created_at")
                        .HasDefaultValueSql("now()");

                    b.Property<string>("data_profile")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("data_profile");

                    b.Property<DateTimeOffset?>("due_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("due_at");

                    b.Property<string>("notes")
                        .HasColumnType("text")
                        .HasColumnName("notes");

                    b.Property<string>("priority_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("normal")
                        .HasColumnName("priority_key");

                    b.Property<string>("project_id")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("project_id");

                    b.Property<string>("source_activity_id")
                        .HasColumnType("text")
                        .HasColumnName("source_activity_id");

                    b.Property<string>("status_key")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("pending")
                        .HasColumnName("status_key");

                    b.Property<string>("template_id")
                        .HasColumnType("text")
                        .HasColumnName("template_id");

                    b.Property<string>("title")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("title");

                    b.Property<DateTimeOffset?>("updated_at")
                        .HasColumnType("timestamptz")
                        .HasColumnName("updated_at");

                    b.HasKey("work_item_id");

                    b.HasIndex("assigned_to_person_id");

                    b.HasIndex("created_at");

                    b.HasIndex("data_profile");

                    b.HasIndex("due_at");

                    b.HasIndex("priority_key");

                    b.HasIndex("project_id");

                    b.HasIndex("source_activity_id");

                    b.HasIndex("status_key");

                    b.HasIndex("title");

                    b.HasIndex("work_item_id");

                    b.ToTable("work_items", null, t =>
                        {
                            t.HasCheckConstraint("CK_work_items_0", "work_item_id ~ '^tsk_[0-9a-hjkmnp-tv-z]{26}$'");
                        });
                });

            modelBuilder.Entity("MGF.Domain.Entities.Client", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("AccountOwnerPersonId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("client_types", null)
                        .WithMany()
                        .HasForeignKey("ClientTypeKey")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("DataProfile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("PrimaryContactPersonId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("client_statuses", null)
                        .WithMany()
                        .HasForeignKey("StatusKey")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("MGF.Domain.Entities.Person", b =>
                {
                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("DataProfile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("host_keys", null)
                        .WithMany()
                        .HasForeignKey("DefaultHostKey")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("person_statuses", null)
                        .WithMany()
                        .HasForeignKey("StatusKey")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("MGF.Domain.Entities.Project", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Client", null)
                        .WithMany()
                        .HasForeignKey("ClientId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("invoices", null)
                        .WithMany()
                        .HasForeignKey("CurrentInvoiceId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("DataProfile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("project_phases", null)
                        .WithMany()
                        .HasForeignKey("PhaseKey")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("project_priorities", null)
                        .WithMany()
                        .HasForeignKey("PriorityKey")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("project_statuses", null)
                        .WithMany()
                        .HasForeignKey("StatusKey")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("activity_acknowledgements", b =>
                {
                    b.HasOne("activity_log", null)
                        .WithMany()
                        .HasForeignKey("activity_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("activity_log", b =>
                {
                    b.HasOne("activity_ops", null)
                        .WithMany()
                        .HasForeignKey("op_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("activity_priorities", null)
                        .WithMany()
                        .HasForeignKey("priority_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("activity_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("activity_topics", null)
                        .WithMany()
                        .HasForeignKey("topic_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("booking_attendees", b =>
                {
                    b.HasOne("bookings", null)
                        .WithMany()
                        .HasForeignKey("booking_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("roles", null)
                        .WithMany()
                        .HasForeignKey("role_key")
                        .OnDelete(DeleteBehavior.Restrict);
                });

            modelBuilder.Entity("bookings", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("created_by_person_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("booking_phases", null)
                        .WithMany()
                        .HasForeignKey("phase_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("project_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("booking_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("client_billing_profiles", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Client", null)
                        .WithMany()
                        .HasForeignKey("client_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("client_contacts", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Client", null)
                        .WithMany()
                        .HasForeignKey("client_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("roles", null)
                        .WithMany()
                        .HasForeignKey("role_key")
                        .OnDelete(DeleteBehavior.Restrict);
                });

            modelBuilder.Entity("client_integrations_square", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Client", null)
                        .WithMany()
                        .HasForeignKey("client_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("square_customer_creation_sources", null)
                        .WithMany()
                        .HasForeignKey("creation_source_key")
                        .OnDelete(DeleteBehavior.Restrict);
                });

            modelBuilder.Entity("deliverable_versions", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("approved_by_person_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("deliverables", null)
                        .WithMany()
                        .HasForeignKey("deliverable_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("uploaded_by_person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("deliverables", b =>
                {
                    b.HasOne("deliverable_versions", null)
                        .WithMany()
                        .HasForeignKey("approved_version_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("created_by_person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("delivery_methods", null)
                        .WithMany()
                        .HasForeignKey("delivery_method_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("invoices", null)
                        .WithMany()
                        .HasForeignKey("invoice_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("project_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("deliverable_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("invoice_integrations_square", b =>
                {
                    b.HasOne("invoices", null)
                        .WithMany()
                        .HasForeignKey("invoice_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("integration_sync_statuses", null)
                        .WithMany()
                        .HasForeignKey("sync_status_key")
                        .OnDelete(DeleteBehavior.Restrict);
                });

            modelBuilder.Entity("invoice_items", b =>
                {
                    b.HasOne("invoices", null)
                        .WithMany()
                        .HasForeignKey("invoice_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("invoices", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Client", null)
                        .WithMany()
                        .HasForeignKey("client_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("currencies", null)
                        .WithMany()
                        .HasForeignKey("currency_code")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("payment_methods", null)
                        .WithMany()
                        .HasForeignKey("payment_method_key")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("project_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("invoice_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("jobs", b =>
                {
                    b.HasOne("activity_log", null)
                        .WithMany()
                        .HasForeignKey("activity_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("job_types", null)
                        .WithMany()
                        .HasForeignKey("job_type_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("job_priorities", null)
                        .WithMany()
                        .HasForeignKey("priority_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("job_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("lead_tags", b =>
                {
                    b.HasOne("leads", null)
                        .WithMany()
                        .HasForeignKey("lead_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("tags", null)
                        .WithMany()
                        .HasForeignKey("tag_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("leads", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("contact_person_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("MGF.Domain.Entities.Client", null)
                        .WithMany()
                        .HasForeignKey("converted_client_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("converted_project_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("service_packages", null)
                        .WithMany()
                        .HasForeignKey("interested_package_key")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("lead_outcomes", null)
                        .WithMany()
                        .HasForeignKey("outcome_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("lead_priorities", null)
                        .WithMany()
                        .HasForeignKey("priority_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("lead_sources", null)
                        .WithMany()
                        .HasForeignKey("source_key")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("lead_stages", null)
                        .WithMany()
                        .HasForeignKey("stage_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("path_settings", b =>
                {
                    b.HasOne("path_templates", null)
                        .WithMany()
                        .HasForeignKey("default_project_root_key")
                        .OnDelete(DeleteBehavior.Restrict);
                });

            modelBuilder.Entity("path_templates", b =>
                {
                    b.HasOne("path_anchors", null)
                        .WithMany()
                        .HasForeignKey("anchor_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("path_types", null)
                        .WithMany()
                        .HasForeignKey("path_type_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("payments", b =>
                {
                    b.HasOne("currencies", null)
                        .WithMany()
                        .HasForeignKey("currency_code")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("invoices", null)
                        .WithMany()
                        .HasForeignKey("invoice_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("payment_methods", null)
                        .WithMany()
                        .HasForeignKey("method_key")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("payment_processors", null)
                        .WithMany()
                        .HasForeignKey("processor_key")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("recorded_by_person_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("payment_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("person_calendar_sync_settings", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("person_contacts", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("person_known_hosts", b =>
                {
                    b.HasOne("host_keys", null)
                        .WithMany()
                        .HasForeignKey("host_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("person_permissions", b =>
                {
                    b.HasOne("permissions", null)
                        .WithMany()
                        .HasForeignKey("permission_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("person_roles", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("roles", null)
                        .WithMany()
                        .HasForeignKey("role_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("project_members", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("project_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("roles", null)
                        .WithMany()
                        .HasForeignKey("role_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("project_storage_roots", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("project_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("storage_providers", null)
                        .WithMany()
                        .HasForeignKey("storage_provider_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("role_scope_roles", b =>
                {
                    b.HasOne("roles", null)
                        .WithMany()
                        .HasForeignKey("role_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("role_scopes", null)
                        .WithMany()
                        .HasForeignKey("scope_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("slug_reservations", b =>
                {
                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("reserved_by_person_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("slug_scopes", null)
                        .WithMany()
                        .HasForeignKey("scope_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("work_item_tags", b =>
                {
                    b.HasOne("tags", null)
                        .WithMany()
                        .HasForeignKey("tag_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("work_items", null)
                        .WithMany()
                        .HasForeignKey("work_item_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });

            modelBuilder.Entity("work_items", b =>
                {
                    b.HasOne("MGF.Domain.Entities.Person", null)
                        .WithMany()
                        .HasForeignKey("assigned_to_person_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("data_profiles", null)
                        .WithMany()
                        .HasForeignKey("data_profile")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("work_item_priorities", null)
                        .WithMany()
                        .HasForeignKey("priority_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("MGF.Domain.Entities.Project", null)
                        .WithMany()
                        .HasForeignKey("project_id")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("activity_log", null)
                        .WithMany()
                        .HasForeignKey("source_activity_id")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("work_item_statuses", null)
                        .WithMany()
                        .HasForeignKey("status_key")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();
                });
#pragma warning restore 612, 618
        }
    }
}



